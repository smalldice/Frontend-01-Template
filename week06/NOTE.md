# 第一步提供接口

# 第二步创建状态机

## 使用 FSM 实现 HTML 的分析

## 在 HTML 标准中 定义好了状态

## toy-browser 选择部分状态实现

# 第三步总结

## 主要标签有： 开始标签， 结束标签， 和自封闭标签

## 暂时忽略属性

# 第四步 创建元素

## 除了状态迁移， 还要加入业务逻辑

## 提交 token

# 第五步 处理属性

# 第六步构建 dom tree

## 从标签构建 DOM 树的基本技巧是使用栈

## 遇到开始标签时创建元素并且入栈， 遇到结束标签时出栈

## 自封闭节点可以视为入栈后立即出栈

## 任何元素的父元素是它入栈前的栈顶

# 第七步 处理文本节点

# CSS Computing

## step1 解析规则

#### 遇到 style 标签时， 保存 css 规则

#### 使用 css parser 分析 css 规则

#### 研究 css 规则

## step2 添加调用

#### 创建一个元素后 立即计算 css

#### 分析一个元素时， 所有 css 规则已经收集完毕

#### 真实浏览器中国， 遇到写在 body 内的 style 标签， 需要重新计算 css 所以先忽略

## step3 获取父元素序列

#### 必须知道所有父元素才能判断元素与规则是否匹配

#### 从 stack 中能够获取 stack， 可以获取本元素的所有的父元素

#### 因为首先获取的是当前元素， 所以我们获得和计算元素匹配的顺序是从内向外

## step4 拆分选择器

#### 选择器也要从当前元素向外排列

#### 复杂选择器拆成针对单个元素的选择器， 用循环匹配父元素队列

## step 5 计算选择器与元素的匹配关系

#### 根据选择的类型和元素属性， 计算当前元素是否匹配

#### 实现了最基本的选择器

## step 6 生成 computed 属性

#### 一旦形成匹配就将计算好的 computedStyle 的样式中

## step 7 生成优先级

#### 实现 specificity(selector) 函数
